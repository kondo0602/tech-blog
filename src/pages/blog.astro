---
import { getCollection } from "astro:content";
import Badge from "@components/Badge.astro";
import Timestamp from "@components/Timestamp.astro";
import BaseLayout from "@layouts/BaseLayout.astro";

const pageTitle = "Blog";
const allPosts = await getCollection("posts");

const date = new Date("2023-01-23T01:23:45Z");
const formated = new Intl.DateTimeFormat("ja-JP", {
  dateStyle: "medium",
  timeStyle: "medium",
  timeZone: "Asia/Tokyo",
}).format(date);
console.log(formated);
---

<BaseLayout title={pageTitle}>
  <ul class="flex flex-col gap-8">
    {
      allPosts.map((post) => (
        <li class="py-4">
          <article class="flex flex-col gap-2">
            <Timestamp date={post.data.pubDate} />
            <a href={`/posts/${post.slug}/`}>
              <h2 class="text-2xl font-bold leading-8 tracking-tight text-primary">
                {post.data.title}
              </h2>
            </a>
            <div class="flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <Badge tag={tag} />
              ))}
            </div>
            <div class="prose max-w-none">
              <p class="text-secondary">{post.data.description}</p>
            </div>
          </article>
        </li>
      ))
    }
  </ul>
</BaseLayout>
